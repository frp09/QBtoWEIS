# Generic modeling options file to run standard WISDEM case
General:
    verbosity: False  # When set to True, the code prints to screen many infos

    qblade_configuration:
        flag: True
        # path2qb_libs: /home/rease/papi/Software/QBladeEE_2.0.8.7_dev/Libraries
        # path2qb_dll: /home/rease/papi/Software/QBladeEE_2.0.8.7_dev/libQBladeEE_2.0.8.7_dev.so.1.0.0
        QB_run_mod: MED15-300_v16.2.0_SONATA_PC
        QB_run_dir: m_output_MED15-300_v16.2.0_SONATA_PC/MED15-300_v16.2.0_PRECOMP_PC
        number_of_workers: 3    
        model_only: False
        
WISDEM:
    RotorSE:
        flag: True
        n_span: 30
        n_pitch_perf_surfaces: 10
        n_tsr_perf_surfaces: 10
        spar_cap_ss: Spar_Cap_SS
        spar_cap_ps: Spar_Cap_PS
        te_ss: TE_reinforcement_SS
        te_ps: TE_reinforcement_PS
        peak_thrust_shaving: False
        thrust_shaving_coeff: 0.8
        n_sector: 8
        hubloss: true
        tiploss: true
        wakerotation: true
        usecd: true
    DriveSE:
        flag: True
    TowerSE:             # Options of TowerSE module
        flag: True
    BOS:
        flag: False
    FixedBottomSE:
        flag: true
        
QBlade: 
    flag: True
    simulation:
        Simulate: True
        TMax: 10.0
        TIMESTEP: 0.05
        STOREFROM: 0.0
        PRESCRIBETYPE: 0
        MEANINF:        [8, 10.0, 25] # [3, 4, 5, 6, 7, 8, 8.5, 9.0, 9.5, 10.0, 11, 13, 15, 17, 19, 21, 23, 25]
        RPMPRESCRIBED:  [5,5.8, 5.8] # [2, 2.8, 3.1, 4, 4.456, 5, 5.3, 5.73, 5.8, 5.8, 5.8, 5.8, 5.8, 5.8, 5.8, 5.8, 5.8, 5.8]
        INITIAL_PITCH:  [-1.5, 4, 28] # [3, 2.4, 1.5, 0, -1, -1.5, -0.5, 0.5, 1.5, 4, 8, 11, 14, 18, 21, 24, 26, 28]
        STORESIM: True
        ISOFFSHORE: 1
        ADDDAMP: 20
        ADDDAMPFACTOR: 10
        WNDTYPE: 0
    Aero:
        ROTORTYPE: HAWT         # only option for now
        INVERTEDFOILS: False    # dummy variable, only used for VAWTs
    Main:
        GLBGEOEPS: 0.2
        DRTRDOF: False
        DEF_OUT: True
        BLD_1: [0.0, 0.05, 0.1, 0.15, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.85, 0.9, 0.95, 1.0]
        BLD_2: [0.0, 0.05, 0.1, 0.15, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.85, 0.9, 0.95, 1.0]
        BLD_3: [0.0, 0.05, 0.1, 0.15, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.85, 0.9, 0.95, 1.0]
        TWR: [0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]
    Tower:
        # RAYLEIGHDMP: 0.0161 # IEA15MW value
        CRITDAMP: 2
        STIFFTUNER: 10.0 #INCRESED STIFFNESS TO AVOID PROBLEMS
        MASSTUNER: 1.0
        DISC: 20
    Blade:
        # RAYLEIGHDMP: 0.02 # IEA15MW value
        CRITDAMP: 3
        # CRITDAMP: 30 # overdampen optimization runs to avoid instabilities
        STIFFTUNER: 1.0
        MASSTUNER: 1.0
        DISCTYPE: 1 ######################### [cosine interpolation and decrease the number of stations]
        DISC: 50
        BEAMTYPE: 1
    Turbine:
        CONTROLLERTYPE: 1
        CONTROLLERFILE: 'libdiscon_ROSCO-2.9.0'
        DISCTYPE: 1 ######################### [cosine interpolation, and decrease the number of stations]
        NUMPANELS: 40
        WAKETYPE: 1
        BEMSPEEDUP: 20
        DYNSTALLTYPE: 2
        UNSTEADYAERO: True
    QBladeOcean:
        override_morison_coefficients: True
        override_wave: False       # override Hs and Tp from windIO with "SIGHEIGHT" and "PEAKPERIOD"
        HydroCdN: 1.0
        HydroCaN: 1.0
        HydroCpN: 0.0
        HydroCdA: 1.6
        HydroCaA: 1.0
        HydroCpA: 0.0
        MCFC: 1
        IsBuoy: 1

SONATA:
    flag: False
    radial_stations: [0., 0.02, 0.05, 0.1, 0.125, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.6, 0.7, 0.8, 0.85, 0.9, 0.925, 0.95, 0.985, 1]
    mesh_resolution: 400
    choose_cutoff: 2

ROSCO:
    flag: True      
    DISCON:
        #prperties:
        LoggingLevel: 0 # (0- write no debug files, 1- write standard output .dbg-file, 2- write standard output .dbg-file and complete avrSWAP-array .dbg2-file)
        F_LPFType: 1 # 1- first-order low-pass filter, 2- second-order low-pass filter (currently filters generator speed and pitch control signals
        VS_ControlMode: 2 #Generator torque control mode in above rated conditions (0- no torque control, 1- k*omega^2 with PI transitions, 2- WSE TSR Tracking, 3- Power-based TSR Tracking)
        VS_ConstPower: 1 # Do constant power torque control, where above rated torque varies
        F_NotchType: 0 # Notch on the measured generator speed and/or tower fore-aft motion (for floating) (0- disable, 1- generator speed, 2- tower-top fore-aft motion, 3- generator speed and tower-top fore-aft motion)
        IPC_ControlMode: 0 # Turn Individual Pitch Control (IPC) for fatigue load reductions (pitch contribution) (0- off, 1- 1P reductions, 2- 1P+2P reductions)
        PC_ControlMode: 1 #Blade pitch control mode (0- No pitch, fix to fine pitch, 1- active PI blade pitch control)
        Y_ControlMode: 0 #Yaw control mode (0- no yaw control, 1- yaw rate control, 2- yaw-by-IPC)
        SS_Mode: 1 #Setpoint Smoother mode (0- no setpoint smoothing, 1- introduce setpoint smoothing)
        WE_Mode: 2 #Wind speed estimator mode (0- One-second low pass filtered hub height wind speed, 1- Immersion and Invariance Estimator, 2- Extended Kalman Filter)
        PS_Mode: 1 #Pitch saturation mode (0- no pitch saturation, 1- implement pitch saturation)
        SD_Mode: 0 #Shutdown mode (0- no shutdown procedure, 1- pitch to max pitch at shutdown)
        Fl_Mode: 1 #Floating specific feedback mode (0- no nacelle velocity feedback, 1- feed back translational velocity, 2- feed back rotational veloicty)
        Flp_Mode: 0 #Flap control mode (0- no flap control, 1- steady state flap angle, 2- Proportional flap control)
        OL_Mode: 0 #Open loop control mode (0 - no open-loop control, 1 - direct open loop control, 2 - rotor position control)
        PA_Mode: 0 #Pitch actuator mode {0 - not used, 1 - first order filter, 2 - second order filter}
        F_LPFCornerFreq: 0.91328 #Corner frequency (-3dB point) in the low-pass filters, 
        F_LPFDamping: 0 #Damping coefficient (used only when F_FilterType = 2 [-]
        F_NumNotchFilts: 1 #Number of notch filters placed on sensors
        F_NotchFreqs: 1.4977 #Natural frequency of the notch filters. Array with length F_NumNotchFilts
        F_NotchBetaNum: 0 #Damping value of numerator (determines the width of notch). Array with length F_NumNotchFilts, [-]
        F_NotchBetaDen: 0.25 #Damping value of denominator (determines the depth of notch). Array with length F_NumNotchFilts, [-]
        F_GenSpdNotch_N: 0 #Number of notch filters on generator speed
        F_TwrTopNotch_N: 1 #Number of notch filters on tower top acceleration signal
        F_GenSpdNotch_Ind: 0 #Indices of notch filters on generator speed
        F_TwrTopNotch_Ind: 1 #Indices of notch filters on tower top acceleration signal
        F_SSCornerFreq: 0.628
        F_WECornerFreq: 0.20000 #Corner frequency (-3dB point) in the first order low pass filter for the wind speed estimate 
        F_FlCornerFreq: [0.271748, 1.000] #Natural frequency and damping in the second order low pass filter of the tower-top fore-aft motion for floating feedback control 
        F_FlHighPassFreq: 0.01042
        F_FlpCornerFreq: [8.3149, 1.0000] #Corner frequency and damping in the second order low pass filter of the blade root bending moment for flap control 
        PC_GS_n: 30 #Amount of gain-scheduling table entries
        PC_GS_angles: [0.076083, 0.104688, 0.126357, 0.145495, 0.162494, 0.178036, 0.192511, 0.206329, 0.219134, 0.23184, 0.243634, 0.255191, 0.266695, 0.277357, 0.288015, 0.298666, 0.308612, 0.318571, 0.328551, 0.338056, 0.347439, 0.356847, 0.366088, 0.374993, 0.383919, 0.392873, 0.401475, 0.409975, 0.418502, 0.427065] #Gain-schedule table- pitch angles 
        PC_GS_KP: [-1.48978535, -1.3093499, -1.16582665, -1.04894105, -0.95190645, -0.8700617, -0.80009895, -0.7396054, -0.6867812, -0.6402542, -0.5989623, -0.56206895, -0.52890595, -0.49893575, -0.4717183, -0.44689025, -0.4241513, -0.40324795, -0.3839657, -0.3661245, -0.3495677, -0.3341614, -0.3197899, -0.30635245, -0.2937613, -0.2819378, -0.27081435, -0.26033115, -0.2504336, -0.24107425] #Gain-schedule table- pitch controller kp gains 
        PC_GS_KI: [-0.183068, -0.162209, -0.145616, -0.132104, -0.120886, -0.111424, -0.103336, -0.096343, -0.090236, -0.084857, -0.080083, -0.075818, -0.071984, -0.06852, -0.065373, -0.062503, -0.059874, -0.057457, -0.055228, -0.053166, -0.051252, -0.049471, -0.047809, -0.046256, -0.0448, -0.043433, -0.042147, -0.040935, -0.039791, -0.038709] #Gain-schedule table- pitch controller ki gains 
        PC_GS_KD: [0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000] #Gain-schedule table- pitch controller kd gains
        PC_GS_TF: [0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000] #Gain-schedule table- pitch controller tf gains (derivative filter)
        PC_MaxPit: 1.57 #Maximum physical pitch limit, 
        PC_MinPit: -0.07 #Minimum physical pitch limit, 
        PC_MaxRat: 0.034910 #Maximum pitch rate (in absolute value) in pitch controller
        PC_MinRat: -0.034910 #Minimum pitch rate (in absolute value) in pitch controller
        # PC_RefSpd: 0.73944 #Desired (reference) HSS speed for pitch controller
        PC_FinePit: -0.04 #Record 5- Below-rated pitch angle set-point
        PC_Switch: 0.017450 #Angle above lowest minimum pitch angle for switch
        VS_GenEff: 95.4 #Generator efficiency mechanical power -> electrical power, should match the efficiency defined in the generator properties
        # VS_ArSatTq: 31219733.35544 #Above rated generator torque PI control saturation
        VS_MaxRat: 4500000 #Maximum torque rate (in absolute value) in torque controller
        # VS_MaxTq: 34341706.69098 #Maximum generator torque in Region 3 (HSS side)
        VS_MinTq: 0.0 #Minimum generator torque (HSS side)
        VS_MinOMSpd: 0.193310 #Minimum generator speed 
        # VS_Rgn2K: 74886972.34611 #Generator torque constant in Region 2 (HSS side). Only used in VS_ControlMode = 1,3
        VS_RtPwr: 15000000.00000 #Wind turbine rated power 
        # VS_RtTq: 31219733.35544 #Rated torque
        # VS_RefSpd: 0.739440 #Rated generator speed 
        # VS_n: 1 #Number of generator PI torque controller gains
        # VS_KP: -60043514.84423 #Proportional gain for generator PI torque controller. (Only used in the transitional 2.5 region if VS_ControlMode =/ 2)
        # VS_KI: -10832724.20937 #Integral gain for generator PI torque controller  (Only used in the transitional 2.5 region if VS_ControlMode =/ 2)
        VS_TSRopt: 10.0 #Power-maximizing region 2 tip-speed-ratio. Only used in VS_ControlMode = 2.
        VS_PwrFiltF: 0.314 #Low pass filter on power used to determine generator speed set point.  Only used in VS_ControlMode = 3.
        SS_VSGain: 1.0 #Variable speed torque controller setpoint smoother gain
        SS_PCGain: 0.0010 #Collective pitch controller setpoint smoother gain
        #PS_BldPitchMin_N: 44 #Number of values in minimum blade pitch lookup table (should equal number of values in PS_WindSpeeds and PS_BldPitchMin)
        #PS_WindSpeeds: [3, 3.5, 4, 4.5, 5, 5.5, 6, 6.5, 7, 7.5, 8, 8.5, 9, 9.5, 10, 10.533, 11.05, 11.567, 12.083, 12.6, 13.117, 13.633, 14.15, 14.667, 15.183, 15.7, 16.217, 16.733, 17.25, 17.767, 18.283, 18.8, 19.317, 19.833, 20.35, 20.867, 21.383, 21.9, 22.417, 22.933, 23.45, 23.967, 24.483, 25] #Wind speeds corresponding to minimum blade pitch angles
        #PS_BldPitchMin: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.005, 0.008, 0.015, 0.028, 0.035, 0.043, 0.06, 0.069, 0.08, 0.087, 0.093, 0.1, 0.1048, 0.1128, 0.12, 0.128, 0.136, 0.1432, 0.1504, 0.1576, 0.1648, 0.172, 0.1792, 0.1856, 0.1928, 0.2, 0.2064, 0.2136, 0.22, 0.2264, 0.2336, 0.24, 0.2464, 0.2528, 0.2592, 0.2656]
       # PS_BldPitchMin: [-0.006108652, -0.008726646, -0.013962634, -0.019198622, -0.02443461, -0.027925268, -0.031415927, -0.039269908, -0.047996554, -0.030543262, -0.013962634, 0, 0.013962634, 0.027925268, 0.041015237, 0.0621, 0.072, 0.0783, 0.0837, 0.09, 0.0945, 0.1017, 0.108, 0.1152, 0.1224, 0.1287, 0.135, 0.1422, 0.1485, 0.1548, 0.1611, 0.1674, 0.1737, 0.18, 0.1854, 0.1926, 0.198, 0.2034, 0.2106, 0.216, 0.2214, 0.2277, 0.2331, 0.2394]
        PS_BldPitchMin_N: 35
        PS_WindSpeeds: [3.000000000000000000e+00,3.647058823529411686e+00,4.294117647058823373e+00,4.941176470588235503e+00,5.588235294117646745e+00,6.235294117647058876e+00,6.882352941176471006e+00,7.529411764705882248e+00,8.176470588235293491e+00,8.823529411764706509e+00,9.470588235294117752e+00,1.011764705882352899e+01,1.076470588235294201e+01,1.141176470588235325e+01,1.205882352941176450e+01,1.270588235294117752e+01,1.335294117647058876e+01,1.400000000000000000e+01,1.464705882352941302e+01,1.529411764705882426e+01,1.594117647058823550e+01,1.658823529411764852e+01,1.723529411764705799e+01,1.788235294117647101e+01,1.852941176470588402e+01,1.917647058823529349e+01,1.982352941176470651e+01,2.047058823529411953e+01,2.111764705882352899e+01,2.176470588235294201e+01,2.241176470588235503e+01,2.305882352941176450e+01,2.370588235294117752e+01,2.435294117647059053e+01,2.500000000000000000e+01]
        PS_BldPitchMin: [-8.726646259971647737e-03,-2.344091663822737287e-02,-3.546325732522653124e-02,-4.319785371357749704e-02,-4.750009653656865616e-02,-5.076890319486823677e-02,-5.231831364318356714e-02,-4.593345660143839659e-02,-3.013916827583940777e-02,-6.458393201965558633e-03,1.612348401869516390e-02,5.652681753673131221e-02,7.685136088056863934e-02,9.334240141504399069e-02,1.067640422008155759e-01,1.178803862985414591e-01,1.274555367688796625e-01,1.362535966724882641e-01,1.450386690700254388e-01,1.543742932947348157e-01,1.633280619927029442e-01,1.717164538423312237e-01,1.796103864574222220e-01,1.870807774517787569e-01,1.941985444392032856e-01,2.010346050334985146e-01,2.076598768484671231e-01,2.141232613138455143e-01,2.203945292953848889e-01,2.264560775670000081e-01,2.322923266504899331e-01,2.378876970676536418e-01,2.432266093402901119e-01,2.482934839901985435e-01,2.530727415391778035e-01]
        SD_CornerFreq: 0.418880 #Cutoff Frequency for first order low-pass filter for blade pitch angle
        #Fl_n: 1 #Number of Fl_Kp gains in gain scheduling, optional with default of 1
        #Fl_Kp: [-0.1478] #Nacelle velocity proportional feedback gain 
        #Fl_U: [12.0902] #Wind speeds for scheduling Fl_Kp, optional if Fl_Kp is single value [m/s]     
